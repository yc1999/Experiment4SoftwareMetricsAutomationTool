<!DOCTYPE html>
<html lang="en" class="loading">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
  <meta name="description"
    content="Convex admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities.">
  <meta name="keywords"
    content="admin template, Convex admin template, dashboard template, flat admin template, responsive admin template, web app">
  <meta name="author" content="PIXINVENT">
  <title>软件度量实验</title>
  <link rel="apple-touch-icon" sizes="60x60" href="app-assets/img/ico/apple-icon-60.png">
  <link rel="apple-touch-icon" sizes="76x76" href="app-assets/img/ico/apple-icon-76.png">
  <link rel="apple-touch-icon" sizes="120x120" href="app-assets/img/ico/apple-icon-120.png">
  <link rel="apple-touch-icon" sizes="152x152" href="app-assets/img/ico/apple-icon-152.png">
  <link rel="shortcut icon" type="image/x-icon" href="app-assets/img/ico/favicon.ico">
  <link rel="shortcut icon" type="image/png" href="app-assets/img/ico/favicon-32.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-touch-fullscreen" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link
    href="https://fonts.googleapis.com/css?family=Rubik:300,400,500,700,900%7CMontserrat:300,400,500,600,700,800,900"
    rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="app-assets/fonts/feather/style.min.css">
  <link rel="stylesheet" type="text/css" href="app-assets/fonts/simple-line-icons/style.css">
  <link rel="stylesheet" type="text/css" href="app-assets/fonts/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="app-assets/vendors/css/perfect-scrollbar.min.css">
  <link rel="stylesheet" type="text/css" href="app-assets/vendors/css/prism.min.css">
  <link rel="stylesheet" type="text/css" href="app-assets/vendors/css/pickadate/pickadate.css">
  <link rel="stylesheet" type="text/css" href="app-assets/css/app.css">
  <link rel="stylesheet" type="text/css" href="app-assets/vendors/css/wizard.css">
</head>

<body data-col="2-columns" class=" 2-columns ">
  <!-- ////////////////////////////////////////////////////////////////////////////-->
  <div class="wrapper">


    <div data-active-color="white" data-background-color="crystal-clear" data-image="app-assets/img/sidebar-bg/08.jpg"
      class="app-sidebar">
      <div class="sidebar-header">
        <div class="logo clearfix"><a href="index.html" class="logo-text float-left">
            <span
              class="text align-middle">软件度量实验</span>
          </a><a id="sidebarToggle" href="javascript:;" class="nav-toggle d-none d-sm-none d-md-none d-lg-block"><i
              data-toggle="expanded" class="ft-disc toggle-icon"></i></a><a id="sidebarClose" href="javascript:;"
            class="nav-close d-block d-md-block d-lg-none d-xl-none"><i class="ft-circle"></i></a></div>
      </div>
      <div class="sidebar-content">
        <div class="nav-container">
          <ul id="main-menu-navigation" data-menu="menu-navigation" class="navigation navigation-main">
            <li><a href="index.html" ><i class="icon-equalizer"></i>首页</a>
            </li>
            <li><a href="FPMetrics.html"><i class="icon-speedometer"></i>功能点度量</a>
            </li>
            <li class="active"><a href="UCPMetrics.html"><i class="icon-grid"></i>用例点度量</a>
            </li>
            <li ><a href="VG.html" ><i class="icon-puzzle"></i>圈复杂度度量</a>
            </li>
            <li><a href="CKMetrics.html" ><i class="icon-pie-chart"></i>面向对象CK度量</a>
            </li>
            <li><a href="LKMetrics.html"><i class="icon-bar-chart"></i>面向对象LK度量</a>
            </li>
            <li  ><a href="countCode.html" ><i class="icon-support"></i>代码行度量</a>
            </li>
        </ul>
        </div>
      </div>
      <div class="sidebar-background"></div>
    </div>

    <div class="main-panel">
      <div class="main-content">
        <div class="content-wrapper">
          <div class="container-fluid">
            <!-- Wizard Starts -->
            <section id="icon-tabs">
              <div class="row">
                <div class="col-12">
                  <div class="card">
                    <div class="card-header">
                      <div class="card-title-wrap bar-danger">
                        <h4 class="card-title">用例点度量方法</h4>
                      </div>
                    </div>
                    <div class="card-body">
                      <div class="card-block">
                        <form class="icons-tab-steps wizard-circle">



                          <!-- Step 1 -->
                          <h6>计算未调整的用例点</h6>
                          <fieldset>

                            <!-- 上传XML文件 -->
                            <div class="row">
                              <div class="col-lg-11 col-md-11">
                                <div class="input-group mb-3">
                                  <div class="input-group-prepend">
                                    <span class="input-group-text">上传文件</span>
                                  </div>
                                  <div class="custom-file">
                                    <input type="file" class="custom-file-input" id="inputFile">
                                    <label class="custom-file-label" for="inputGroupFile01" id="fileName">选择文件</label>
                                  </div>
                                </div>
                              </div>
                              <div class="col-lg-1 col-md-1">
                                <a class="btn mr-1 btn-success" id="checkBtn">确定</a>
                              </div>
                            </div>

                            <div id="actosrArea">
                              <h4 class="form-section">
                                <i class="icon-pin"></i>
                                设置用例图角色类型
                              </h4>
                              <div>
                              </div>
                              <div class="row" id="actorTypeSelector">
                              </div>
                              <div class="row">
                                <div class="col-lg-3 col-md-3">
                                </div>
                                <div class="col-lg-3 col-md-3">
                                </div>
                                <div class="col-lg-3 col-md-3">
                                </div>
                                <div class="col-lg-3 col-md-3">
                                  <fieldset>
                                    <div class="input-group">
                                      <div class="input-group-prepend">
                                        <button class="btn btn-info" type="button">未调整的角色权重</button>
                                      </div>
                                      <input type="text" class="form-control" placeholder="" id="uaw" disabled>
                                    </div>
                                  </fieldset>
                                </div>
                              </div>
                            </div>


                            <div id="usecasesArea">
                              <h4 class="form-section">
                                <i class="icon-pin"></i>
                                设置用例图用例类型
                              </h4>
                              <div class="row" id="usecaseTypeSelector">

                              </div>
                              <div class="row">
                                <div class="col-lg-3 col-md-3">
                                </div>
                                <div class="col-lg-3 col-md-3">
                                </div>
                                <div class="col-lg-3 col-md-3">
                                </div>
                                <div class="col-lg-3 col-md-3">
                                  <fieldset>
                                    <div class="input-group">
                                      <div class="input-group-prepend">
                                        <button class="btn btn-info" type="button">未调整的用例权重</button>
                                      </div>
                                      <input type="text" class="form-control" placeholder="" id="uuc" disabled>
                                    </div>
                                  </fieldset>
                                </div>
                              </div>
                            </div>

                            <div id="uucpArea">
                              <h4 class="form-section">
                                <i class="icon-pin"></i>
                                未调整的用例点
                              </h4>
                              <div class="row">
                                <div class="col-lg-3 col-md-3">
                                </div>
                                <div class="col-lg-3 col-md-3">
                                </div>
                                <div class="col-lg-3 col-md-3">
                                </div>
                                <div class="col-lg-3 col-md-3">
                                  <fieldset>
                                    <div class="input-group">
                                      <div class="input-group-prepend">
                                        <button class="btn btn-info" type="button">未调整的用例点</button>
                                      </div>
                                      <input type="text" class="form-control" placeholder="" id="uucp" disabled>
                                    </div>
                                  </fieldset>
                                </div>
                              </div>
                            </div>
                          </fieldset>

                          <!-- Step 2 -->
                          <h6>计算技术复杂因子</h6>
                          <fieldset>
                            <div id="usecasesArea">
                              <h4 class="form-section">
                                <i class="icon-pin"></i>
                                设置技术复杂因子
                              </h4>
                              <div class="row" id="TFSelector">
                              </div>
                              <div class="row">
                                <div class="col-lg-3 col-md-2">
                                </div>
                                <div class="col-lg-3 col-md-2">
                                </div>
                                <div class="col-lg-3 col-md-2">
                                </div>
                                <div class="col-lg-3 col-md-2">
                                  <fieldset>
                                    <div class="input-group">
                                      <div class="input-group-prepend">
                                        <button class="btn btn-info" type="button">技术复杂因子</button>
                                      </div>
                                      <input type="text" class="form-control" placeholder="" id="tcf" disabled>
                                    </div>
                                  </fieldset>
                                </div>
                              </div>
                            </div>
                          </fieldset>
                          <!-- Step 3 -->
                          <h6>计算环境复杂因子</h6>
                          <fieldset>
                            <div id="usecasesArea">
                              <h4 class="form-section">
                                <i class="icon-pin"></i>
                                设置环境复杂因子
                              </h4>
                              <div class="row" id="EFSelector">
                              </div>
                              <div class="row">
                                <div class="col-lg-3 col-md-2">
                                </div>
                                <div class="col-lg-3 col-md-2">
                                </div>
                                <div class="col-lg-3 col-md-2">
                                </div>
                                <div class="col-lg-3 col-md-2">
                                  <fieldset>
                                    <div class="input-group">
                                      <div class="input-group-prepend">
                                        <button class="btn btn-info" type="button">环境复杂因子</button>
                                      </div>
                                      <input type="text" class="form-control" placeholder="" id="ef" disabled>
                                    </div>
                                  </fieldset>
                                </div>
                              </div>
                            </div>
                          </fieldset>
                          <!-- Step 4 -->
                          <h6>计算调整后的用例点</h6>
                          <fieldset>
                            <div class="row">
                              <div class="col-lg-4">
                                <blockquote class="blockquote">
                                  <p class="mb-0">UCP = UUCP * TCF * EF
                                  </p>
                                </blockquote>
                              </div>
                            </div>

                            <div class="row">
                              <div class="col-lg-3 col-md-2">
                                <fieldset>
                                  <div class="input-group">
                                    <div class="input-group-prepend">
                                      <button class="btn btn-info" type="button">用例点</button>
                                    </div>
                                    <input type="text" class="form-control" placeholder="" id="ucp" disabled>
                                  </div>
                                </fieldset>
                              </div>
                            </div>

                            <!--人时-->
                            <div class="row">
                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label for="humanhour" class="text-bold-400">请输入完成一个用例需要的人时</label>
                                  <div class="input-group">
                                    <input type="text" id="humanhour" name="humanhour" class="form-control" placeholder="28">
                                    <div class="input-group-append">
                                      <span class="input-group-text">
                                        人时
                                      </span>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>

                            <!--单位换算-->
                            <div class="row">
                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label for="monthhour" class="text-bold-400">请输入一个人月对应的人时</label>
                                  <div class="input-group">
                                    <input type="text" id="monthhour" name="monthhour" class="form-control" placeholder="167">
                                    <div class="input-group-append">
                                      <span class="input-group-text">
                                        人时
                                      </span>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>

                            <!--结果-->
                            <div class="row">
                              <div class="col-lg-3 col-md-2">
                                <fieldset>
                                  <div class="input-group">
                                    <div class="input-group-prepend">
                                      <button class="btn btn-info" type="button">预计工作量</button>
                                    </div>
                                    <input type="text" class="form-control" placeholder="" id="effort" disabled>
                                    <div class="input-group-append">
                                      <span class="input-group-text">
                                        人月
                                      </span>
                                    </div>
                                  </div>
                                </fieldset>
                              </div>
                            </div>
                          </fieldset>


                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </section>
            <!-- Wizard Ends -->
          </div>
        </div>
      </div>

      <footer class="footer footer-static footer-light">
        <p class="clearfix text-muted text-center px-2"><span>Copyright &copy; 2020 <a href="https://www.csu.edu.cn"
              id="pixinventLink" target="_blank" class="text-bold-800 primary darken-2">CSU</a>, All rights reserved.
          </span></p>
      </footer>

    </div>
  </div>
  <!-- ////////////////////////////////////////////////////////////////////////////-->

  <!-- BEGIN VENDOR JS-->
  <script src="app-assets/vendors/js/core/jquery-3.3.1.min.js"></script>
  <script src="app-assets/vendors/js/core/popper.min.js"></script>
  <script src="app-assets/vendors/js/core/bootstrap.min.js"></script>
  <script src="app-assets/vendors/js/perfect-scrollbar.jquery.min.js"></script>
  <script src="app-assets/vendors/js/prism.min.js"></script>
  <script src="app-assets/vendors/js/jquery.matchHeight-min.js"></script>
  <script src="app-assets/vendors/js/screenfull.min.js"></script>
  <script src="app-assets/vendors/js/pace/pace.min.js"></script>
  <!-- BEGIN VENDOR JS-->
  <!-- BEGIN PAGE VENDOR JS-->
  <script src="app-assets/vendors/js/jquery.steps.min.js"></script>
  <script src="app-assets/vendors/js/pickadate/picker.js"></script>
  <script src="app-assets/vendors/js/pickadate/picker.date.js"></script>
  <script src="app-assets/vendors/js/pickadate/picker.time.js"></script>
  <script src="app-assets/vendors/js/pickadate/legacy.js"></script>
  <script src="app-assets/vendors/js/jquery.validate.min.js"></script>
  <!-- END PAGE VENDOR JS-->
  <!-- BEGIN CONVEX JS-->
  <script src="app-assets/js/app-sidebar.js"></script>
  <script src="app-assets/js/notification-sidebar.js"></script>
  <!-- END CONVEX JS-->
  <!-- BEGIN PAGE LEVEL JS-->
  <script src="app-assets/js/wizard-steps.js"></script>
  <!-- END PAGE LEVEL JS-->

  <script>
    var data;
    $("#actosrArea").hide()
    $("#usecasesArea").hide()
    $("#uucpArea").hide()


    //加载技术复杂因子界面
    var tfs = new Array("分布式系统", "响应或吞吐量性能", "终端用户效率", "复杂的内部处理", "代码必须重用", "易安装性", "易用性", "可移植性", "易更改性", "并发性", "特殊的安全性", "提供第三方接口", "需要特别的用户培训")
    var tfws = [2, 1, 1, 1, 1, 0.5, 0.5, 2, 1, 1, 1, 1, 1]

    for (var i = 0; i < 13; i++) {
      var element =
        '<div class="col-md-2">' +
        '<fieldset class="form-group">' +
        '<label for="' + 'tf' + i + '" class="font-medium-1 text-bold-400">' + tfs[i] + '</label>' +
        '<select id="' + 'tf' + i + '" name="interested" class="form-control tf">' +
        '<option value="0" selected="">0</option>' +
        '<option value="1">1</option>' +
        '<option value="2">2</option>' +
        '<option value="3">3</option>' +
        '<option value="4">4</option>' +
        '<option value="5">5</option>' +
        '</select>' +
        '</fieldset>' +
        '</div>'
      $("#TFSelector").append(element)
    }
    var tfactor = 0;
    for (var i = 0; i < 13; i++) {
      tfactor = tfactor + parseInt($("#tf" + i).children('option:selected').val()) * tfws[i]
    }
    var tcf = 0.6 + (0.01 * tfactor)


    //加载环境复杂因子界面
    var efs = new Array("熟悉UML程度", "应用程序开发经验", "面向对象的经验", "主分析师能力", "激励机制", "需求稳定度", "具有兼职人员", "具有复杂编程")
    var efws = [1.5, 0.5, 1, 0.5, 1, 2, -1, -1]

    for (var i = 0; i < 8; i++) {
      var element =
        '<div class="col-md-2">' +
        '<fieldset class="form-group">' +
        '<label for="' + 'ef' + i + '" class="font-medium-1 text-bold-400">' + efs[i] + '</label>' +
        '<select id="' + 'ef' + i + '" name="interested" class="form-control ef">' +
        '<option value="0" selected="">0</option>' +
        '<option value="1">1</option>' +
        '<option value="2">2</option>' +
        '<option value="3">3</option>' +
        '<option value="4">4</option>' +
        '<option value="5">5</option>' +
        '</select>' +
        '</fieldset>' +
        '</div>'
      $("#EFSelector").append(element)
    }
    var efactor = 0;
    for (var i = 0; i < 8; i++) {
      efactor = efactor + parseInt($("#ef" + i).children('option:selected').val()) * efws[i]
    }
    var ef = 1.4 + (-0.03 * efactor)

    //设置uucp
    var uucp = 0

    //设置ucp
    var ucp = 0


    //设置人时，人月
    var humanhour = 28;
    var monthhour = 167;
    var preEffort = 0;
    var effort = 0;

    //究极jquery操作
    $(document).ready(function () {

      //Step 1
      $("#inputFile").change(function () {
        $("#fileName").text("已选择文件：" + $("#inputFile")[0].files[0].name);
        var reader = new FileReader();
        reader.readAsText($("#inputFile")[0].files[0], "UTF-8");//读取文件 
        reader.onload = function (evt) { //读取完文件之后会回来这里
          data = evt.target.result;
        }
      });

      $("#checkBtn").click(function () {
        $.ajax({
          url: "http://127.0.0.1:8080/UCPMetrics",
          type: 'post',
          async: false,//使用同步的方式,true为异步方式
          processData: false,
          data: data,
          contentType: "application/xml",
          success: function (res) {
            console.log(res);
            //得到角色和用例列表
            var actors = res.actors
            var usecases = res.usecases

            //1. 设置角色类型的选择列表
            for (var i = 0; i < actors.length; i++) {
              var element =
                '<div class="col-md-3">' +
                '<fieldset class="form-group">' +
                '<label for="' + 'actor' + i + '" class="font-medium-1 text-bold-400">' + actors[i] + '</label>' +
                '<select id="' + 'actor' + i + '" name="interested" class="form-control actor">' +
                '<option value="1" selected="">简单</option>' +
                '<option value="2">普通</option>' +
                '<option value="3">复杂</option>' +
                '</select>' +
                '</fieldset>' +
                '</div>'
              $('#actorTypeSelector').append(element)
            }
            $("#uaw").val(actors.length)
            $("#actosrArea").show()

            //2. 设置用例类型的选择列表
            for (var i = 0; i < usecases.length; i++) {
              var element =
                '<div class="col-md-3">' +
                '<fieldset class="form-group">' +
                '<label for="' + 'usecase' + i + '" class="font-medium-1 text-bold-400">' + usecases[i] + '</label>' +
                '<select id="' + 'usecase' + i + '" name="interested" class="form-control usecase">' +
                '<option value="5" selected="">简单</option>' +
                '<option value="10">普通</option>' +
                '<option value="15">复杂</option>' +
                '</select>' +
                '</fieldset>' +
                '</div>'
              $('#usecaseTypeSelector').append(element)
            }
            $("#uuc").val(usecases.length * 5)
            $("#usecasesArea").show()

            uucp = usecases.length * 5 + actors.length
            $("#uucp").val(uucp)
            $("#uucpArea").show()

            ucp = uucp * tcf * ef
            $("#ucp").val(ucp.toFixed(2))

            preEffort = ucp * humanhour;
            effort = preEffort / monthhour;
            $("#effort").val(effort.toFixed(0))

            //3. 绑定事件函数
            $('.actor').change(function () {
              var uaw = 0;
              $(".actor").each(function (ii, vv) {
                uaw = uaw + parseInt($(vv).children('option:selected').val())
              });
              $("#uaw").val(uaw)
              uucp = parseInt($("#uaw").val()) + parseInt($("#uuc").val())
              $("#uucp").val(uucp)

              ucp = uucp * tcf * ef
              $("#ucp").val(ucp.toFixed(2))

              preEffort = ucp * humanhour;
              effort = preEffort / monthhour;
              $("#effort").val(effort.toFixed(0))
            })

            $('.usecase').change(function () {
              var uuc = 0;
              $(".usecase").each(function (ii, vv) {
                uuc = uuc + parseInt($(vv).children('option:selected').val())
              });
              $("#uuc").val(uuc)
              uucp = parseInt($("#uaw").val()) + parseInt($("#uuc").val())
              $("#uucp").val(uucp)

              ucp = uucp * tcf * ef
              $("#ucp").val(ucp.toFixed(2))

              preEffort = ucp * humanhour;
              effort = preEffort / monthhour;
              $("#effort").val(effort.toFixed(0))
            })
          },
          error: function (data) {
            console.log(data)
          }
        });
      });



      //Step 2           
      $("#tcf").val(tcf)
      //绑定事件函数
      $('.tf').change(function () {
        var tfactor = 0;
        for (var i = 0; i < 13; i++) {
          tfactor = tfactor + parseInt($("#tf" + i).children('option:selected').val()) * tfws[i]
        }
        tcf = 0.6 + (0.01 * tfactor)
        $("#tcf").val(tcf.toFixed(3))

        ucp = uucp * tcf * ef
        $("#ucp").val(ucp.toFixed(2))

        preEffort = ucp * humanhour;
        effort = preEffort / monthhour;
        $("#effort").val(effort.toFixed(0))
      })



      //Step 3
      $("#ef").val(ef)
      //绑定事件函数
      $('.ef').change(function () {
        var efactor = 0;
        for (var i = 0; i < 8; i++) {
          efactor = efactor + parseInt($("#ef" + i).children('option:selected').val()) * efws[i]
        }
        ef = 1.4 + (-0.03 * efactor)
        $("#ef").val(ef.toFixed(3))

        console.log("uucp:" + uucp)
        console.log("tcf:" + tcf)
        console.log("ef:" + ef)

        ucp = uucp * tcf * ef
        $("#ucp").val(ucp.toFixed(2))

        preEffort = ucp * humanhour;
        effort = preEffort / monthhour;
        $("#effort").val(effort.toFixed(0))
      })


      //Step 4
      $('#humanhour').on('change', function(){
        humanhour = parseInt($("#humanhour").val())
        preEffort = ucp * humanhour;
        effort = preEffort / monthhour;
        $("#effort").val(effort.toFixed(0))
        // console.log("preEffort: "+preEffort)
      });

      $('#monthhour').on('change', function(){
        preEffort = ucp * humanhour;
        monthhour = parseInt($("#monthhour").val())
        effort = preEffort / monthhour;
        $("#effort").val(effort.toFixed(0))
      });
    });

  </script>
</body>

</html>